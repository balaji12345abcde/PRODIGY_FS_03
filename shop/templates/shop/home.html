{% extends 'shop/base.html' %}
{% block content %}
<h2>Products</h2>
<form method="get" style="margin-bottom:10px;">
  <input name="q" placeholder="Search" value="{{ request.GET.q }}">
  <select name="sort">
    <option value="">Sort</option>
    <option value="price_asc">Price ↑</option>
    <option value="price_desc">Price ↓</option>
  </select>
  <input type="submit" value="Go">
</form>
<div class="products">
  {% for p in products %}
    <div class="card">
      {% if p.image %}<img src="{{ p.image.url }}" alt="{{ p.name }}">{% endif %}
      <h3><a href="{% url 'product_detail' p.pk %}">{{ p.name }}</a></h3>
      <p>{{ p.category }} • ₹{{ p.price }}</p>
      <p>{{ p.description|truncatechars:80 }}</p>
      <a class="btn" href="{% url 'add_to_cart' p.pk %}">Add to cart</a>
    </div>
  {% empty %} <p>No products yet.</p> {% endfor %}
</div>
{% endblock %}
